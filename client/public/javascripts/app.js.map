{"version":3,"file":"public/javascripts/app.js","sources":["app/config.coffee","app/configform.coffee","app/en.coffee","app/router.coffee","app/initialize.coffee"],"names":[],"mappings":"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","sourcesContent":["path = require 'path-extra'\nfs = require 'fs'\n\nhomedir = path.homedir()\nconfigDir = path.join homedir, '.cozy-data-proxy'\nconfigPath = path.join configDir, 'config.json'\nif not fs.existsSync configPath\n    fs.writeFileSync configPath, JSON.stringify devices: {}, null, 2\n\nconfig = require configPath\n\nkeys = Object.keys config.devices\ndevice = config.devices[keys[0]] if keys.length > 0\ndevice ?= {}\n\nconfigHelpers =\n\n    saveConfigSync: (deviceConfig) ->\n        delete config.devices[device.deviceName]\n        for key, value of deviceConfig\n            device[key] = deviceConfig[key]\n        config.devices[device.deviceName] = device\n\n        fs.writeFileSync configPath, JSON.stringify config, null, 2\n        console.log 'Configuration file successfully updated'\n\n    getState: ->\n        console.log device\n        if not device.deviceName?\n            'INTRO'\n        else if not device.path?\n            'STEP1'\n        else if not device.deviceId?\n            'STEP2'\n        else\n            'STATE'\n","ReactCSSTransitionGroup = React.addons.CSSTransitionGroup\n\n\nisValidForm = (fields) ->\n    for field in fields\n        unless field.isValid()\n            return false\n    true\n\n\nLine = React.createClass\n    render: ->\n        div className: 'line mtl clearfix', @props.children\n\n\nContainer = React.createClass\n    render: ->\n        ReactCSSTransitionGroup transitionName: \"slide\", component: div,\n            div className: 'container', @props.children\n\n\nTitle = React.createClass\n    render: ->\n            h1 {}, @props.text\n\nButton = React.createClass\n    render: ->\n        button\n            className: 'btn btn-cozy ' + @props.className\n            ref: @props.ref\n            onClick: @props.onClick\n        , @props.text\n\n\nField = React.createClass\n\n    getInitialState: ->\n        error: null\n\n    render: ->\n        @props.type ?= 'text'\n        Line null,\n            label className: 'mod w100 mrm', @props.label\n            input\n                type: @props.type\n                className: 'mt1 ' + @props.fieldClass\n                ref: @props.inputRef\n                defaultValue: @props.defaultValue\n                onChange: @onChange\n                placeholder: @props.placeholder\n            if @state.error\n                p null, @state.error\n\n    getValue: ->\n        @refs[@props.inputRef].getDOMNode().value\n\n    isValid: ->\n        console.log @getValue()\n        @getValue() isnt ''\n\n    onChange: ->\n        val = @refs[@props.inputRef].getDOMNode().value\n        if val is ''\n            @setState error: 'value is missing'\n        else\n            @setState error: null\n\n\nIntro = React.createClass\n\n    render: ->\n        Container null,\n           div className: 'txtcenter mtl',\n               img\n                   src: 'client/public/icon/bighappycloud.png'\n               p className: 'mtl', 'welcome to the cozy data proxy'\n               Button\n                    className: 'mtl txtbigger pam'\n                    onClick: @onEnterClicked\n                    text: t 'start configuring your device and sync it with your cozy'\n\n    onEnterClicked: ->\n        db = require './backend/db'\n        console.log db\n        renderState 'STEP1'\n\n\nConfigFormStepOne = React.createClass\n    render: ->\n        Container null,\n            Title text: t 'cozy files configuration 1 on 3'\n            Field\n                label: t 'your device name'\n                fieldClass: 'w300p'\n                inputRef: 'deviceName'\n                defaultValue: @props.deviceName\n                ref: 'deviceNameField'\n                placeholder: 'Laptop'\n            Field\n                label: t 'directory to synchronize your data'\n                fieldClass: 'w500p'\n                inputRef: 'path'\n                defaultValue: @props.path\n                ref: 'devicePathField'\n                placeholder: '/home/john/mycozyfolder'\n            Line null,\n                Button\n                    className: 'right'\n                    onClick: @onSaveButtonClicked\n                    text: t 'save your device information and go to step 2'\n\n    onSaveButtonClicked: ->\n        fieldName = @refs.deviceNameField\n        fieldPath = @refs.devicePathField\n        isValid = isValidForm [fieldName, fieldPath]\n        if isValid\n            configHelpers.saveConfigSync\n                deviceName: fieldName.getValue()\n                path: fieldPath.getValue()\n            renderState 'STEP2'\n        else\n            alert 'a value is missing'\n\n\nConfigFormStepTwo = React.createClass\n    render: ->\n        Container null,\n            Title text: t 'cozy files configuration 2 on 3'\n            Field\n                label: t 'your remote url'\n                fieldClass: 'w300p'\n                inputRef: 'remoteUrl'\n                defaultValue: @props.url\n                ref: 'remoteUrlField'\n                placeholder: 'john.cozycloud.cc'\n            Field\n                label: t 'your remote password'\n                fieldClass: 'w300p'\n                type: 'password'\n                inputRef: 'remotePassword'\n                defaultValue: @props.remotePassword\n                ref: 'remotePasswordField'\n            Line null,\n                Button\n                    className: 'left'\n                    ref: 'backButton'\n                    onClick: @onBackButtonClicked\n                    text: t 'go back to previous step'\n                Button\n                    className: 'right'\n                    ref: 'nextButton'\n                    onClick: @onSaveButtonClicked\n                    text: t 'register device and synchronize'\n\n    onBackButtonClicked: ->\n        renderState 'STEP1'\n\n    onSaveButtonClicked: ->\n        fieldUrl = @refs.remoteUrlField\n        fieldPassword = @refs.remotePasswordField\n        isValid = isValidForm [fieldUrl, fieldPassword]\n        if isValid\n            configHelpers.saveConfigSync\n                url: fieldUrl.getValue()\n            # TODO Register to remote Cozy\n            renderState 'STEP3'\n        else\n            alert 'a value is missing'\n\n\nConfigFormStepThree = React.createClass\n    render: ->\n      div className: 'container',\n          h1 {}, 'Cozy Files Configuration (3/3)'\n          h2 {}, 'Run replications...'\n          div className: 'line device-name',\n\n\nStateView = React.createClass\n    render: ->\n      div className: 'container',\n          h1 {}, 'Cozy Files'\n","en =\n    'cozy files configuration 1 on 3': 'Configure your device (1/3)'\n    'cozy files configuration 2 on 3': 'Register your device (2/3)'\n    'cozy files configuration 3 on 3': 'Synchronization (3/3)'\n    'directory to synchronize your data': 'Path of the folder where you will see your cozy files:'\n    'your device name': 'The name used to register your device to your:'\n    'your remote url': 'The web URL of your Cozy'\n    'your remote password': 'The password you use to connect to your Cozy:'\n    'go back to previous step': '< Previous step'\n    'save your device information and go to step 2': 'Save then go to next step >'\n    'register device and synchronize': 'Register then go to next step >'\n\n","router = React.createClass\n    render: ->\n      div className: \"router\", \"Hello, I am a router.\"\n","{div, p, img, label, input, h1, h2, button} = React.DOM\n\n\nrenderState = (state) ->\n    switch state\n        when 'INTRO'\n            currentComponent = Intro()\n        when 'STEP1'\n            currentComponent = ConfigFormStepOne device\n        when 'STEP2'\n            currentComponent = ConfigFormStepTwo device\n        when 'STEP3'\n            currentComponent = ConfigFormStepThree device\n        when 'STATE'\n            currentComponent = StateView device\n        else\n            currentComponent = Intro()\n\n    React.renderComponent currentComponent , document.body\n\n\n# Waits for the DOM to be ready\nwindow.onload = ->\n\n    window.__DEV__ = window.location.hostname is 'localhost'\n\n    # use Cozy instance locale or navigator language or \"en\" by default\n    locale = window.locale or window.navigator.language or \"en\"\n    locales = {}\n    polyglot = new Polyglot()\n    locales = en\n    polyglot.extend locales\n    window.t = polyglot.t.bind polyglot\n\n    renderState configHelpers.getState()\n"]}